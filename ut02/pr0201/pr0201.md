# PR0201: Usuarios y permisos

## 1 Permisos de usuarios

1- Crea el directorio pr0201 dentro de tu directorio personal y dentro de él crea los directorios dir1 y dir2 ¿Cuáles son los permisos del directorio dir1? No pongas una captura, explica quiénes tienen permisos sobre el directorio y qué pueden hacer en él.

`drwxrwxr-x Tienen permiso de lectura, escritura y ejecución tanto el propietario como el grupo al que pertenece, pero solo lectura y ejecución en resto de usuarios`

2- Utilizando la notación simbólica, elimina todos los permisos de escritura (propietario, grupo, otros) del directorio dir2.

`chmod ugo-w dir2`

3- Utilizando la notación octal, elimina el permiso de lectura del directorio dir2, al resto de los usuarios.

`chmod 551 dir2`

4- ¿Cuáles son ahora los permisos asociados a dir2?

`Ahora los permisos asociados a dir2 son de lectura y ejecución para el propietario y el grupo al que pertenece pero solo de ejecución para otros usuarios`

5- Crear bajo dir2, un directorio llamado dir21.

`Se me muestra un mensaje de que no tengo permisos para crearlo: "mkdir: cannot create directory ‘dir21’: Permission denied"`

6- Concédete a ti mismo permiso de escritura en el directorio dir2 e intenta de nuevo el paso anterior.

`Una vez modificado los permisos de propietario con "chmod 751 dir2" si he podido crear el dir21`

## 2 Notación octal y simbólica

1- Supón que el fichero ~/file tiene los permisos rw-r--r--. Escribe el comando o comandos que necesitarías para establecer los siguientes permisos en el fichero anterior utilizando notación simbólica.

rwxrwxr-x : `chmod u=rwx,g=rwx,o=rx file`

rwxr--r-- : `chmod u=rwx,g=r,o=r file`

r--r----- : `chmod u=r,g=r,o=  file`

rwxr-xr-x : `chmod u=rwx,g=rx,o=rx file`

rwxr-xr-x : `chmod u=rwx,g=rx,o=rx file`

r-x--x--x : `chmod u= ,g=x,o=rwx file`

-w-r----x : `chmod u=r,g=w,o=x file`

-----xrwx : `chmod u= ,g=x,o=rwx file`

r---w---x : `chmod u=r,g=w,o=x file`

-w------- : `chmod u=w,g= ,o=  file`

rw-r----- : `chmod u=rw,g=r,o=  file`

rwx--x--x : `chmod u=rwx,g=x,o=x file`

## 3 El bit setgid

1- Crea un grupo llamado asir y los usuarios {iniciales}1 e {iniciales}2 , donde
{iniciales} son las iniciales de tu nombre. Por ejemplo, en mi caso se llamarían vjgr1 y
vjgr2 . Haz que los usuarios pertenezcan al grupo.

Primero creamos el grupo.

`sudo groupadd asir`

Y luego creamos los usuarios donde el -m crea el directorio /home para ese usuario, -s define el shell, en este caso /bin/bash, y el -G añade al usuario a un grupo.

`sudo useradd -m -s /bin/bash -G asir jmg1`
`sudo useradd -m -s /bin/bash -G asir jmg2`

Asignar contraseñas a los usuarios.

`sudo passwd jmg1`

`sudo passwd jmg2`

2- Crea el directorio /compartido y asigna propietario: root como usuario propietario y asir
como grupo propietario.

`sudo mkdir /compartido`

`sudo chown root:asir /compartido`

3- Asigna al directorio creado permisos de lectura, escritura y ejecución para el usuario y el
grupo propietario. El resto de usuarios no tendrá ningún tipo de permiso.

`sudo chmod 770 /compartido`

4- Establece el bit setgid en el directorio y verifica que se haya asignado.

`sudo chmod g+s /compartido`

`ls -ld /compartido`

Al verse los permisos "drwxrws---", la s en la parte de grupo nos indica que el bit setgid está activado.

5- Inicia sesión con usuario1 , accede al directorio y crea un fichero llamado fichero1 con
algo de contenido. Comprueba los permisos del fichero que has creado.

Cambiamos de usuario.

`su jmg1`

Creamos un txt y le añado contenido con un nano.

`touch /compartido/ejercicio5.txt`

Estos son los permisos del fichero que he creado "-rw-rw-r--".

6- Ahora inicia sesión con usuario2 y comprueba si puedes acceder a /compartido/fichero1 y
si puedes añadirle contenido.

`su jmg2`

Puedo ver y modificar el archivo.

7- Responde las siguientes preguntas:

    ◦ ¿Qué ventajas tiene usar el bit setgid en entornos colaborativos?

    Henecia automatica del grupo, todos los usuarios que pertenezcan a el grupo propietario podrán trabajar sin que accedan otros usuarios.

    ◦ ¿Qué sucede si no se aplica el bit setgid en un entorno colaborativo?

    Los archivos heredaran el grupo principal del usuario, con lo que no podrían acceder a no ser que el usuario perteneciese al grupo en cuestión, y el administrador tendría más trabajo.

8- Cuando hayas acabado, limpia el sistema eliminando los usuarios y el directorio creado para
la práctica.

Borramos el directorio.

`sudo rm -r /compartido`

Borramos los usuarios.

`sudo userdel -r jmg1`

`sudo userdel -r jmg2`

## 4 El sticky bit

1- Crea el directorio /compartido con todos los permisos para todos los usuarios.

Creamos el directorio.

`sudo mkdir -p /compartido`

Asignamos los permisos.

`sudo chmod 777 /compartido`

2- Crea dos usuarios {iniciales}1 e {iniciales}2.

`sudo adduser jmg1`

`sudo adduser jmg2`

3- Vamos a probar primero el funcionamiento sin el sticky bit. Inicia sesión con el primer
usuario, crea un fichero y luego, con el segundo usuario, intenta eliminarlo.

Iniciamos sesión en el primer usuario creado.

`su jmg1`

Nos situamos sobre la carpeta /compartido.

`cd /compartido`

Creamos el fichero.

`sudo touch fichero`

Ahora lo intentamos eliminar con el otro usuario.

`su jmg2`

`sudo rm -r fichero`

No podemos eliminarlo.

6- Responde las siguientes preguntas:

¿Qué efecto tiene el sticky bit en un directorio?

`El sticky bit en un directorio hace que solo el propietario del archivo, el propietario del directorio o root puedan borrar o renombrar archivos dentro de él.`

Si tienes habilitado el sticky bit, ¿cómo tendrías que hacer para eliminar un fichero dentro del directorio?

`Si el sticky bit está activado, solo el propietario del archivo, del directorio o root pueden eliminar el fichero, aunque otros tengan permisos de escritura.`